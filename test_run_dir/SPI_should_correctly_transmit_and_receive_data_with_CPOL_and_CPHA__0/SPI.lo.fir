FIRRTL version 1.2.0
circuit SPI :
  module SPI :
    input clock : Clock
    input reset : UInt<1>
    input io_cs : UInt<1> @[src/main/scala/SPI.scala 7:14]
    input io_cpol : UInt<1> @[src/main/scala/SPI.scala 7:14]
    input io_cpha : UInt<1> @[src/main/scala/SPI.scala 7:14]
    input io_dataIn : UInt<8> @[src/main/scala/SPI.scala 7:14]
    input io_transmit : UInt<1> @[src/main/scala/SPI.scala 7:14]
    output io_mosi : UInt<1> @[src/main/scala/SPI.scala 7:14]
    input io_miso : UInt<1> @[src/main/scala/SPI.scala 7:14]
    output io_clock : UInt<1> @[src/main/scala/SPI.scala 7:14]
    output io_dataOut : UInt<8> @[src/main/scala/SPI.scala 7:14]
    output io_done : UInt<1> @[src/main/scala/SPI.scala 7:14]

    reg state : UInt<2>, clock with :
      reset => (UInt<1>("h0"), state) @[src/main/scala/SPI.scala 22:22]
    reg shiftReg : UInt<8>, clock with :
      reset => (UInt<1>("h0"), shiftReg) @[src/main/scala/SPI.scala 23:25]
    reg counter : UInt<4>, clock with :
      reset => (UInt<1>("h0"), counter) @[src/main/scala/SPI.scala 24:24]
    reg clockReg : UInt<1>, clock with :
      reset => (UInt<1>("h0"), clockReg) @[src/main/scala/SPI.scala 25:25]
    node _io_mosi_T = bits(shiftReg, 7, 7) @[src/main/scala/SPI.scala 28:22]
    node _T = eq(UInt<2>("h0"), state) @[src/main/scala/SPI.scala 39:19]
    node _GEN_0 = mux(io_transmit, UInt<2>("h1"), state) @[src/main/scala/SPI.scala 41:27 42:17 22:22]
    node _GEN_1 = mux(io_transmit, io_dataIn, shiftReg) @[src/main/scala/SPI.scala 41:27 43:20 23:25]
    node _GEN_2 = mux(io_transmit, UInt<1>("h0"), counter) @[src/main/scala/SPI.scala 41:27 44:19 24:24]
    node _GEN_3 = mux(io_transmit, UInt<1>("h0"), UInt<1>("h0")) @[src/main/scala/SPI.scala 30:11 41:27 45:19]
    node _T_1 = eq(UInt<2>("h1"), state) @[src/main/scala/SPI.scala 39:19]
    node _T_2 = lt(counter, UInt<4>("h8")) @[src/main/scala/SPI.scala 49:22]
    node _clockReg_T = eq(clockReg, UInt<1>("h0")) @[src/main/scala/SPI.scala 50:23]
    node _T_3 = eq(io_cpol, UInt<1>("h0")) @[src/main/scala/SPI.scala 53:29]
    node _T_4 = eq(clockReg, _T_3) @[src/main/scala/SPI.scala 53:25]
    node _shiftReg_T = bits(shiftReg, 6, 0) @[src/main/scala/SPI.scala 57:41]
    node _shiftReg_T_1 = cat(_shiftReg_T, io_miso) @[src/main/scala/SPI.scala 57:32]
    node _counter_T = add(counter, UInt<1>("h1")) @[src/main/scala/SPI.scala 58:36]
    node _counter_T_1 = tail(_counter_T, 1) @[src/main/scala/SPI.scala 58:36]
    node _GEN_4 = mux(clockReg, _shiftReg_T_1, shiftReg) @[src/main/scala/SPI.scala 23:25 56:30 57:26]
    node _GEN_5 = mux(clockReg, _counter_T_1, counter) @[src/main/scala/SPI.scala 24:24 56:30 58:25]
    node _T_5 = eq(clockReg, UInt<1>("h0")) @[src/main/scala/SPI.scala 62:20]
    node _shiftReg_T_2 = bits(shiftReg, 6, 0) @[src/main/scala/SPI.scala 63:41]
    node _shiftReg_T_3 = cat(_shiftReg_T_2, io_miso) @[src/main/scala/SPI.scala 63:32]
    node _counter_T_2 = add(counter, UInt<1>("h1")) @[src/main/scala/SPI.scala 64:36]
    node _counter_T_3 = tail(_counter_T_2, 1) @[src/main/scala/SPI.scala 64:36]
    node _GEN_6 = mux(_T_5, _shiftReg_T_3, shiftReg) @[src/main/scala/SPI.scala 23:25 62:31 63:26]
    node _GEN_7 = mux(_T_5, _counter_T_3, counter) @[src/main/scala/SPI.scala 24:24 62:31 64:25]
    node _GEN_8 = mux(io_cpha, _GEN_4, _GEN_6) @[src/main/scala/SPI.scala 54:27]
    node _GEN_9 = mux(io_cpha, _GEN_5, _GEN_7) @[src/main/scala/SPI.scala 54:27]
    node _GEN_10 = mux(_T_4, _GEN_8, shiftReg) @[src/main/scala/SPI.scala 23:25 53:39]
    node _GEN_11 = mux(_T_4, _GEN_9, counter) @[src/main/scala/SPI.scala 24:24 53:39]
    node _GEN_12 = mux(_T_2, _clockReg_T, clockReg) @[src/main/scala/SPI.scala 49:33 50:20 25:25]
    node _GEN_13 = mux(_T_2, _GEN_10, shiftReg) @[src/main/scala/SPI.scala 23:25 49:33]
    node _GEN_14 = mux(_T_2, _GEN_11, counter) @[src/main/scala/SPI.scala 24:24 49:33]
    node _GEN_15 = mux(_T_2, UInt<1>("h0"), shiftReg) @[src/main/scala/SPI.scala 29:14 49:33 69:22]
    node _GEN_16 = mux(_T_2, state, UInt<2>("h2")) @[src/main/scala/SPI.scala 22:22 49:33 70:17]
    node _T_6 = eq(UInt<2>("h2"), state) @[src/main/scala/SPI.scala 39:19]
    node _T_7 = eq(io_transmit, UInt<1>("h0")) @[src/main/scala/SPI.scala 75:14]
    node _GEN_17 = mux(_T_7, UInt<2>("h0"), state) @[src/main/scala/SPI.scala 75:28 76:17 22:22]
    node _GEN_18 = mux(_T_6, UInt<1>("h1"), UInt<1>("h0")) @[src/main/scala/SPI.scala 30:11 39:19 74:17]
    node _GEN_19 = mux(_T_6, _GEN_17, state) @[src/main/scala/SPI.scala 39:19 22:22]
    node _GEN_20 = mux(_T_1, _GEN_12, clockReg) @[src/main/scala/SPI.scala 39:19 25:25]
    node _GEN_21 = mux(_T_1, _GEN_13, shiftReg) @[src/main/scala/SPI.scala 39:19 23:25]
    node _GEN_22 = mux(_T_1, _GEN_14, counter) @[src/main/scala/SPI.scala 39:19 24:24]
    node _GEN_23 = mux(_T_1, _GEN_15, UInt<1>("h0")) @[src/main/scala/SPI.scala 29:14 39:19]
    node _GEN_24 = mux(_T_1, _GEN_16, _GEN_19) @[src/main/scala/SPI.scala 39:19]
    node _GEN_25 = mux(_T_1, UInt<1>("h0"), _GEN_18) @[src/main/scala/SPI.scala 30:11 39:19]
    node _GEN_26 = mux(_T, _GEN_0, _GEN_24) @[src/main/scala/SPI.scala 39:19]
    node _GEN_27 = mux(_T, _GEN_1, _GEN_21) @[src/main/scala/SPI.scala 39:19]
    node _GEN_28 = mux(_T, _GEN_2, _GEN_22) @[src/main/scala/SPI.scala 39:19]
    node _GEN_29 = mux(_T, _GEN_3, _GEN_25) @[src/main/scala/SPI.scala 39:19]
    node _GEN_30 = mux(_T, clockReg, _GEN_20) @[src/main/scala/SPI.scala 39:19 25:25]
    node _GEN_31 = mux(_T, UInt<1>("h0"), _GEN_23) @[src/main/scala/SPI.scala 29:14 39:19]
    node _GEN_32 = mux(io_cs, UInt<2>("h0"), _GEN_26) @[src/main/scala/SPI.scala 34:15 35:11]
    node _GEN_33 = mux(io_cs, io_cpol, _GEN_30) @[src/main/scala/SPI.scala 34:15 36:14]
    node _GEN_34 = mux(io_cs, UInt<1>("h0"), _GEN_29) @[src/main/scala/SPI.scala 34:15 37:13]
    node _GEN_35 = mux(io_cs, shiftReg, _GEN_27) @[src/main/scala/SPI.scala 34:15 23:25]
    node _GEN_36 = mux(io_cs, counter, _GEN_28) @[src/main/scala/SPI.scala 34:15 24:24]
    node _GEN_37 = mux(io_cs, UInt<1>("h0"), _GEN_31) @[src/main/scala/SPI.scala 29:14 34:15]
    node _io_done_T = eq(state, UInt<2>("h2")) @[src/main/scala/SPI.scala 83:21]
    io_mosi <= _io_mosi_T @[src/main/scala/SPI.scala 28:11]
    io_clock <= clockReg @[src/main/scala/SPI.scala 84:12]
    io_dataOut <= shiftReg @[src/main/scala/SPI.scala 85:14]
    io_done <= _io_done_T @[src/main/scala/SPI.scala 83:11]
    state <= mux(reset, UInt<2>("h0"), _GEN_32) @[src/main/scala/SPI.scala 22:{22,22}]
    shiftReg <= mux(reset, UInt<8>("h0"), _GEN_35) @[src/main/scala/SPI.scala 23:{25,25}]
    counter <= mux(reset, UInt<4>("h0"), _GEN_36) @[src/main/scala/SPI.scala 24:{24,24}]
    clockReg <= mux(reset, UInt<1>("h0"), _GEN_33) @[src/main/scala/SPI.scala 25:{25,25}]
